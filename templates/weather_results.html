{% extends 'base.html' %}

{% block title %}Weather results{% endblock %} 

{% block content%}
    <h1>Showing weather for {{ place.split("_")[0] }}</h1>
    <p>{{ ", ".join(place.split("_")[1:]) }}</p>
    <div class="weather_content">
        <div class="current_weather">
            {{ current.data.instant.details.air_temperature }}°
            {% set svg_filename = current.data.next_1_hours.summary.symbol_code + ".svg" %}
            <br>
            <div class="weather_box">
                <img width="64" height="64" src="{{ url_for('static', filename='icons/' + svg_filename) }}" alt="">
            </div>
        </div>
        <table class="weather_table">
            {% for hour in result %}
                {% if hour.data.next_1_hours  %}
                    <tr>
                        <td>
                            {{ hour.data.instant.details.air_temperature }}°
                        </td>
                        <td>
                            {{ hour.time }}
                        </td>
                        <td>
                            {% set svg_filename = hour.data.next_1_hours.summary.symbol_code + ".svg" %}
                            <img width="64" height="64" src="{{ url_for('static', filename='icons/' + svg_filename) }}" alt="">
                        </td>
                        <td style="color: blue">
                            {{ hour.data.next_1_hours.details.precipitation_amount }}mm
                        </td>
                        <td>
                            {{ hour.data.instant.details.wind_speed }}m/s 
                            <div class="arrow" style="transform: rotate({{ hour.data.instant.details.wind_from_direction }}deg); display: inline-block">
                                <b>&DownArrow;</b>
                            </div>
                        </td>
                    </tr>
                {% endif %}
            {% endfor %} 
        </table>
        <button id="knapp">Vis mer/mindre</button>
    </div>

    <script>
        const button = document.querySelector("#knapp")
        const tableRows = document.querySelectorAll("table tr");
        tableRows.forEach((row, index) => {
                    if (index >= 4) {
                        row.style.display = "none"
                    }
                })
        let expanded = false;

        button.addEventListener('click',()=>{
            if (expanded) expanded=false
            else expanded = true

            if (expanded) {
                tableRows.forEach(row=>{
                    row.style.display = "table-row"
                })
            } else {
                tableRows.forEach((row, index) => {
                    if (index >= 4) {
                        row.style.display = "none"
                    }
                })
            }
        })
    </script>
 
{% endblock %}

